{% extends "frameWithTitle.html" %}

{% block content %}
<div class="container" style="width: 980px">
    <div class="container" style="width: 980px">

        <div class="container-fluid" style="padding-left: 0px;padding-right: 0px;">
            <div class="row-fluid" >
                <div class="span9">
                    <!-- main -->
                    <div class="row-fluid">
                        <div class="span9" >
                            <h3> {{topic.instance.title}}</h3>
                        </div>
                        <div class="span3" style="padding-top: 30px">
                            <span>类别：{{topic.getCategory.name}}</span>
                        </div>
                    </div>
                    <div class="row-fluid" style="border-top: 1px solid #dddddd;">
                        <div class="span2" style="margin-top: 20px">
                            <img
                            class="img-rounded"
                            alt="140x140"
                            style="width: 60px; height: 60px;"
                            src="http://static.lsapp.com/avatar/a_250X250_{{topic.instance.userid}}.jpg">
                            </img>
                        </div>
                        <div  class="span10" style="margin-left: 0px">
                            <div class="row-fluid">
                                <div class="span12">
                                    <div class="row-fluid">
                                        <div class="span9">
                                            <h5><span >来自： {{topic.instance.username}}</span><span>{{topic.instance.created_at|date:"Y-m-d f"}}</span></h5>
                                        </div>
                                        <div class="span3" style="height:30px;margin-top: 10px;">
                                            <span></span>
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span12">
                                            阅读：{{topic.instance.read_count}}   评论：{{topic.instance.reply_count}}
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span12">
                                            {{topic.instance.content}}
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    {% for reply in reply_list%}
                    <div class="row-fluid" style="border-top: 1px solid #dddddd;">
                        <div class="span2" style="margin-top: 20px">
                            <img
                            class="img-rounded"
                            alt="140x140"
                            style="width: 60px; height: 60px;"
                            src="http://static.lsapp.com/avatar/a_250X250_{{reply.userid}}.jpg">
                            </img>
                        </div>
                        <div  class="span10" style="margin-left: 0px">
                            <div class="row-fluid">
                                <div class="span12">
                                    <div class="row-fluid">
                                        <div class="span12">
                                            <h5><span >来自： {{reply.username}}</span><span>{{reply.created_at|date:"Y-m-d f"}}</span></h5>
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span12">
                                            {{reply.title}}
                                        </div>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span12">
                                            {{reply.content}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    {% if user.is_active %}
                    <div class="row-fluid"  style="border-top: 1px solid #dddddd;margin-top: 5px;padding-top: 10px" >
                            <div class="span2" style="margin-top: 0px">
                                <img
                                class="img-rounded"
                                alt="140x140"
                                style="width: 60px; height: 60px;"
                                src="http://static.lsapp.com/avatar/a_250X250_{{user.id}}.jpg">
                                </img>
                            </div>
                            <div class='span10' style="margin-left: 0px">
                                <form class="form" method="post" id="postTopicReply" onsubmit="return postTopicReply();">
                                     {% csrf_token %}
                                    <div class="control-group">
                                       
                                        <div class="controls">
                                            <textarea rows="3" name="replyContent" style='width: 400px'>评论内容</textarea>
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        <div class="controls">
                                            <button type="submit" class="btn btn-primary">
                                                提交评论
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <script>
                            backdata=''
                            function postTopicReply(){
                                $.post("/topic/{{topic.instance.id}}/add_reply", $("#postTopicReply").serialize()).done(
                                    function(data){
                                        backdata=data
                                        for(key in data){
                                            alert(key+'='+data[key]);
                                        }
                                    }
                                );
                                return false;//不提交页面
                            }
                       
                        </script>
                        {% endif %}
                    </div>
                    <div class="span3">
                        <!--Sidebar content-->
                        <div class="row-fluid">
                            <div class="span12">

                                <ul class="nav nav-list">
                                    <li class="nav-header">
                                        同类热门小说：
                                    </li>
                                    {% for doc in hot_docs %}

                                    <li>
                                        <span><a href="{{doc.source_url}}" target='_blank' style="font-size: 16px">{{doc.topic.title}}</a> 阅读：{{doc.topic.read_count}}</span>
                                    </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        <div class="row-fluid">
                            {% for uf in follows %}
                            <div class="span4">
                                <img
                                class="img-rounded"
                                alt="140x140"
                                style="width: 50px; height: 50px;"
                                src="http://static.lsapp.com/avatar/a_250X250_{{uf.followed_userid}}.jpg">
                                </img>
                            </div>
                            {% endfor%}
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
    {% endblock %}
